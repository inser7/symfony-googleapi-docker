services:
    php:
      build:
        context: ./api
        target: googleapis_php
        <<: *api-cache-from
      image: ${PHP_IMAGE:-quay.io/googleapis/php}
      volumes:
        - ./api:/srv/api:rw,cached
        - ./api/docker/php/conf.d/api-platform.dev.ini/:/usr/local/etc/php/conf.d/api-platform.ini
        # if you develop on Linux, you may use a bind-mounted host directory instead
        # - ./api/var:/srv/api/var:rw
  
    api:
      build:
        context: ./api
        target: googleapis_nginx
        <<: *api-cache-from
      image: ${NGINX_IMAGE:-quay.io/googleapis/nginx}
      depends_on:
        - php
      volumes:
        - ./api/public:/srv/api/public:ro